import{D as t,bE as N,o as $,a5 as B,a6 as h,au as L,I as y,S as s,aA as V,bQ as q,T as j,bF as A,bW as H,aR as M,bR as z,j as D,b9 as w,bq as T,bV as G,B as o,c0 as K,K as P,bt as _,r as Q,am as W,bT as J}from"./index-C2tuPJaA.js";import{r as U}from"./share-DNtGrOny.js";import{T as r}from"./item_type-CV3e5W3l.js";import{R as X}from"./ResponsiveGrid-C5alewH_.js";import{n as Y}from"./index-BIqS3B56.js";const l=e=>{const m=$();return t(z,{w:"$full",display:"flex",flexDirection:"column",get required(){return e.required},get children(){return[t(N,{get for(){return e.name},display:"flex",alignItems:"center",get children(){var a;return m((a=e.full_name_path)!=null?a:"shares.".concat(e.name))}}),t(B,{get fallback(){return t(M,{get children(){return m("settings.unknown_type")}})},get children(){return[t(h,{get when(){return e.type===r.String},get children(){return t(L,{w:"$full",spacing:"$2",get children(){return[t(y,{get id(){return e.name},type:"text",get readOnly(){return e.readonly},get value(){return e.value},get invalid(){return!e.valid},get onChange(){return e.type===r.String?a=>{var u;return(u=e.onChange)==null?void 0:u.call(e,a.currentTarget.value)}:void 0}}),t(s,{get when(){return e.type===r.String&&e.random},get children(){return t(V,{colorScheme:"neutral","aria-label":"random",get icon(){return t(Y,{})},get onClick(){return e.type===r.String?()=>{var a;return(a=e.onChange)==null?void 0:a.call(e,e.random())}:void 0}})}})]}})}}),t(h,{get when(){return e.type===r.Number},get children(){return t(y,{type:"number",get id(){return e.name},get readOnly(){return e.readonly},get value(){return e.value},get invalid(){return!e.valid},get onInput(){return e.type===r.Number?a=>{var u;return(u=e.onChange)==null?void 0:u.call(e,parseInt(a.currentTarget.value))}:void 0}})}}),t(h,{get when(){return e.type===r.Float},get children(){return t(y,{type:"number",get id(){return e.name},get readOnly(){return e.readonly},get value(){return e.value},get invalid(){return!e.valid},get onInput(){return e.type===r.Float?a=>{var u;return(u=e.onChange)==null?void 0:u.call(e,parseFloat(a.currentTarget.value))}:void 0}})}}),t(h,{get when(){return e.type===r.Bool},get children(){return t(q,{get id(){return e.name},get readOnly(){return e.readonly},get defaultChecked(){return e.value},get invalid(){return!e.valid},get onChange(){return e.type===r.Bool?a=>{var u;return(u=e.onChange)==null?void 0:u.call(e,a.currentTarget.checked)}:void 0}})}}),t(h,{get when(){return e.type===r.Text},get children(){return t(j,{get id(){return e.name},get readOnly(){return e.readonly},get value(){return e.value},get invalid(){return!e.valid},get onChange(){return e.type===r.Text?a=>{var u;return(u=e.onChange)==null?void 0:u.call(e,a.currentTarget.value)}:void 0}})}}),t(h,{get when(){return e.type===r.Select},get children(){return t(A,{get id(){return e.name},get readOnly(){return e.readonly},get value(){return e.value},get invalid(){return!e.valid},get onChange(){return e.type===r.Select?a=>{var u;return(u=e.onChange)==null?void 0:u.call(e,a)}:void 0},get children(){return t(H,{get readonly(){return e.readonly},get searchable(){return e.type===r.Select&&e.searchable},get options(){return e.options.split(",").map(a=>{var u;return{key:a,label:m(((u=e.options_prefix)!=null?u:"shares.".concat(e.name,"s"))+".".concat(a))}})}})}})}})]}})]}})},ue=()=>{const e=$(),{params:m,back:a,to:u}=D(),{id:g}=m,[k,F]=w(()=>T.get("/share/get?id=".concat(g)),!0),[d,i]=G({}),[I,b]=o(""),[f,S]=o(!1),[O,x]=o(""),[C,v]=o(!0);g&&(async()=>{const n=await F();_(n,c=>{J(()=>{i(c),b(c.files.join("\n")),c.expires&&x(new Date(c.expires).toLocaleString()),S(!0)})})})();const[R,E]=w(()=>T.post("/share/".concat(g?"update":"create"),d));return t(W,{get loading(){return g?k():!1},get children(){return[t(K,{mb:"$2",get children(){return e("global.".concat(g?"edit":"add"))}}),t(X,{get children(){return[t(s,{when:g,get children(){return t(l,{name:"id",get type(){return r.String},value:g,valid:!0,readonly:!0})}}),t(l,{name:"files",get type(){return r.Text},get value(){return I()},get valid(){return f()},required:!0,onChange:n=>{b(n),S(n.length>0),i("files",n.split("\n"))}}),t(l,{name:"remark",get type(){return r.Text},get value(){return d.remark},valid:!0,onChange:n=>{i("remark",n)}}),t(l,{name:"extract_folder",get type(){return r.Select},get value(){return d.extract_folder},valid:!0,options:"front,back",onChange:n=>{i("extract_folder",n)}}),t(l,{name:"order_by",get type(){return r.Select},get value(){return d.order_by},valid:!0,options:"name,size,modified",onChange:n=>{i("order_by",n)}}),t(l,{name:"order_direction",get type(){return r.Select},get value(){return d.order_direction},valid:!0,options:"asc,desc",onChange:n=>{i("order_direction",n)}}),t(l,{name:"pwd",get type(){return r.String},get value(){return d.pwd},valid:!0,onChange:n=>{i("pwd",n)},random:U}),t(l,{name:"max_accessed",get type(){return r.Number},get value(){return d.max_accessed},valid:!0,onChange:n=>{i("max_accessed",n)}}),t(s,{when:g,get children(){return t(l,{name:"accessed",get type(){return r.Number},get value(){return d.accessed},valid:!0,onChange:n=>{i({...d,accessed:n})}})}}),t(l,{name:"expires",get type(){return r.String},get value(){return O()},get valid(){return C()},onChange:n=>{if(x(n),n===""){v(!0),i("expires",null);return}const c=new Date(n);isNaN(c.getTime())?v(!1):(v(!0),i("expires",c.toISOString()))}}),t(l,{name:"readme",get type(){return r.Text},get value(){return d.readme},valid:!0,onChange:n=>{i("readme",n)}}),t(l,{name:"header",get type(){return r.Text},get value(){return d.header},valid:!0,onChange:n=>{i("header",n)}})]}}),t(P,{mt:"$2",get disabled(){return!C()||!f()},get loading(){return R()},onClick:async()=>{const n=await E();_(n,()=>{Q.success(e("global.save_success")),a()},(c,p)=>{n.data.id&&u("/@manage/shares/edit/".concat(n.data.id))})},get children(){return e("global.".concat(g?"save":"add"))}})]}})};export{ue as default};
