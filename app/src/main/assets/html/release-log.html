<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Release Logs</title>
</head>
<body>
<p align="center">
    <a href="https://github.com/LeoHaoVIP/AListLiteAndroid" target="_blank" rel="noopener noreferrer"><img
            width="80px" src="../images/alistlite.png"/>
    </a>
</p>

<div align="center" id="releases">☻ 加载中...</div>
</body>
<style>
    div {
        font-size: 13px;
        line-height: 1.5;
        word-wrap: break-word;
    }
</style>
<script>
    const RECENT_RELEASE_ITEM_NUM = 10;
    document.addEventListener('DOMContentLoaded', function () {
        const owner = 'LeoHaoVIP';
        const repo = 'AListLiteAndroid';
        const releasesDiv = document.getElementById('releases');
        fetch(`https://api.github.com/repos/${owner}/${repo}/releases`)
            .then(response => response.json())
            .then(releases => {
                let i = 0;
                releasesDiv.innerText = '';
                for (let j = 0; j < releases.length; j++) {
                    const release = releases[j];
                    //发布时间
                    const releaseTime = new Date(release.published_at);
                    // 获取年、月、日、小时、分钟和秒
                    const year = releaseTime.getFullYear();
                    const month = String(releaseTime.getMonth() + 1).padStart(2, '0');
                    const day = String(releaseTime.getDate()).padStart(2, '0');
                    const formattedDate = `发布于 ${year}.${month}.${day}`;
                    //APP 版本号
                    const appVersion = release.tag_name.replaceAll('-', ' ');
                    //基于的 AList 版本号
                    const alistVersion = `基于 ${release.name.substring(5)} 构建`;
                    let releaseBody = release.body.replaceAll('**', '');
                    if (releaseBody.length === 0) {
                        releaseBody = '-';
                    }
                    const releaseDiv = document.createElement('div');
                    const bodyDiv = document.createElement('div');
                    const titleP = document.createElement('p');
                    const dateImg = document.createElement('img');
                    dateImg.src = "https://img.shields.io/badge/" + formattedDate + "-green.svg";
                    dateImg.alt = releaseTime;
                    dateImg.style.marginLeft = '10px';
                    const versionImg = document.createElement('img');
                    versionImg.src = "https://img.shields.io/badge/" + appVersion + "-cc9933.svg";
                    versionImg.alt = appVersion;
                    const alistImg = document.createElement('img');
                    alistImg.src = "https://img.shields.io/badge/" + alistVersion + "-33cccc.svg";
                    alistImg.alt = alistVersion;
                    alistImg.style.marginLeft = '10px';
                    titleP.appendChild(versionImg);
                    titleP.appendChild(dateImg);
                    titleP.appendChild(alistImg);
                    titleP.style.height = '10px';
                    bodyDiv.innerText = releaseBody;
                    releaseDiv.appendChild(titleP)
                    releaseDiv.appendChild(bodyDiv);
                    releaseDiv.style.textAlign = 'left';
                    releasesDiv.appendChild(releaseDiv);
                    i++;
                    if (i === RECENT_RELEASE_ITEM_NUM) {
                        break;
                    }
                }
            }).catch(error => {
            releasesDiv.innerText = '😢 发布日志加载失败';
            console.error('Error fetching releases:', error);
        });
    });
</script>
</html>
